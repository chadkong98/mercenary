import React, { useState, useEffect, useCallback } from 'react';
import { AlertCircle, Skull, Target, Shield } from 'lucide-react';

const MercenaryXRP = () => {
  const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 });
  const [showFlash, setShowFlash] = useState(false);
  const [bgOffset, setBgOffset] = useState({ x: 0, y: 0 });
  
  // Initialize audio
  useEffect(() => {
    // Create audio element once
    const audio = new Audio();
    audio.src = 'data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjM1LjEwNAAAAAAAAAAAAAAA//tQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAdAAARpAAFBQUFDQ0NDQ0VFRUVFRwcHBwcJCQkJCQrKysrKzMzMzMzOzs7OztCQkJCQkpKSkpKUlJSUlJZWVlZWWFhYWFhaWlpaWlwcHBwcHh4eHh4f39/f3+Hh4eHh4+Pj4+Pl5eXl5efn5+fn6ampqamrq6urq62tra2tr6+vr6+xsbGxsbOzs7OztbW1tbW3t7e3t7l5eXl5e3t7e3t9fX19fX9/f39/f///////////////0xhdmY1OC4zNS4xMDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/+5DEAAAGkAF19BAAJbhIrr6WmAL///////////////1ERBQ9ERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERE/+xDE1QAAAAAAAAAAAAA/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////yg=';
    audio.volume = 0.1; // Set volume to 10%
    
    // Add to window to prevent garbage collection
    window.gunSound = audio;
    
    return () => {
      window.gunSound = null;
    };
  }, []);

  // Handle mouse movement
  useEffect(() => {
    const handleMouseMove = (e) => {
      setMousePosition({ x: e.clientX, y: e.clientY });
      setBgOffset({
        x: (e.clientX / window.innerWidth) * 15,
        y: (e.clientY / window.innerHeight) * 15
      });
    };
    
    document.addEventListener('mousemove', handleMouseMove);
    return () => document.removeEventListener('mousemove', handleMouseMove);
  }, []);

  // Handle click effects
  const handleClick = useCallback((e) => {
    // Play sound
    if (window.gunSound) {
      window.gunSound.currentTime = 0;
      window.gunSound.play().catch(e => console.log('Audio play failed:', e));
    }

    // Show muzzle flash
    setShowFlash(true);
    setTimeout(() => setShowFlash(false), 50); // Reduced from 100ms to 50ms
  }, []);

  useEffect(() => {
    document.addEventListener('click', handleClick);
    return () => document.removeEventListener('click', handleClick);
  }, [handleClick]);

  return (
    <div className="relative min-h-screen overflow-hidden bg-black cursor-none">
      {/* Custom Cursor */}
      <div className="fixed pointer-events-none z-50" 
           style={{ 
             left: `${mousePosition.x}px`, 
             top: `${mousePosition.y}px`,
             transform: 'translate(-50%, -50%)'
           }}>
        {/* Muzzle Flash - more subtle and faster */}
        {showFlash && (
          <div className="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2">
            <div className="absolute w-4 h-4 bg-white/90" 
                 style={{ 
                   clipPath: 'polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)',
                   animation: 'flash 0.05s ease-out'
                 }} 
            />
            <div className="absolute w-6 h-6 -ml-1 -mt-1 bg-yellow-500/40" 
                 style={{ 
                   clipPath: 'polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)',
                   animation: 'flash 0.05s ease-out'
                 }} 
            />
          </div>
        )}
        {/* Crosshair */}
        <svg width="64" height="64" className="absolute -ml-8 -mt-8">
          <circle cx="32" cy="32" r="31" stroke="#ff0000" strokeWidth="1" fill="none" opacity="0.5"/>
          <circle cx="32" cy="32" r="1" fill="#ff0000" />
          <line x1="32" y1="20" x2="32" y2="44" stroke="#ff0000" strokeWidth="1" opacity="0.7"/>
          <line x1="20" y1="32" x2="44" y2="32" stroke="#ff0000" strokeWidth="1" opacity="0.7"/>
          <circle cx="32" cy="32" r="4" stroke="#ff0000" strokeWidth="1" fill="none"/>
        </svg>
      </div>

      {/* Rest of the component stays the same */}
      <div 
        className="absolute inset-0 bg-[url('/api/placeholder/1920/1080')] bg-cover bg-center"
        style={{
          transform: `translate(${-bgOffset.x}px, ${-bgOffset.y}px)`,
          filter: 'brightness(0.6)',
        }}
      />
      
      <div className="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-80" />
      
      {/* Content */}
      <div className="relative z-10">
        {/* Main content remains the same */}
        <div className="min-h-screen flex flex-col items-center justify-center px-4 text-center">
          <div className="space-y-6 max-w-4xl mx-auto">
            <h1 className="text-7xl font-bold text-white tracking-wider animate-pulse">
              MERCENARY
              <span className="text-red-600">XRP</span>
            </h1>
            
            <p className="text-2xl text-gray-300 font-medium tracking-wide">
              SURVIVE • TRADE • DOMINATE
            </p>
            
            <div className="flex gap-4 justify-center mt-8">
              <button className="bg-red-600 hover:bg-red-700 text-white px-8 py-4 rounded 
                transform transition-all duration-300 hover:scale-105 
                border border-red-500 hover:border-red-400
                shadow-lg hover:shadow-red-600/50">
                JOIN THE RANKS
              </button>
              <button className="bg-transparent text-white px-8 py-4 rounded
                border border-white/30 hover:border-white/50
                transform transition-all duration-300 hover:scale-105
                backdrop-blur-sm">
                INTEL BRIEF
              </button>
            </div>
          </div>
        </div>

        {/* Stats and nav remain the same */}
        <div className="absolute bottom-0 left-0 right-0 bg-black/50 backdrop-blur-md border-t border-red-900/30">
          <div className="container mx-auto grid grid-cols-2 md:grid-cols-4 gap-4 p-6">
            <div className="text-center">
              <div className="text-3xl font-bold text-red-600">24.5K</div>
              <div className="text-gray-400 text-sm">ACTIVE SOLDIERS</div>
            </div>
            <div className="text-center">
              <div className="text-3xl font-bold text-red-600">$2.1M</div>
              <div className="text-gray-400 text-sm">24H VOLUME</div>
            </div>
            <div className="text-center">
              <div className="text-3xl font-bold text-red-600">142K</div>
              <div className="text-gray-400 text-sm">TRANSACTIONS</div>
            </div>
            <div className="text-center">
              <div className="text-3xl font-bold text-red-600">$0.89</div>
              <div className="text-gray-400 text-sm">CURRENT PRICE</div>
            </div>
          </div>
        </div>

        <nav className="absolute top-0 right-0 p-6 flex gap-6">
          <button className="text-gray-400 hover:text-red-500 transition-colors">ARMORY</button>
          <button className="text-gray-400 hover:text-red-500 transition-colors">INTEL</button>
          <button className="text-gray-400 hover:text-red-500 transition-colors">MISSIONS</button>
          <button className="text-gray-400 hover:text-red-500 transition-colors">COMMAND</button>
        </nav>
      </div>
    </div>
  );
};

export default MercenaryXRP;
